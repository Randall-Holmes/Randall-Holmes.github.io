\documentclass[12pt]{article}

\title{A theory of sets as symmetric classes as a foundation for mathematics}

\author{M. Randall Holmes}

\usepackage{amssymb}

\usepackage{comment}

\begin{document}

\maketitle


Here I will try to give a ``naive" self contained account of a theory of sets in which the sets are the classes which are symmetric in a suitable sense.

There is a domain of objects.  We represent properties of these objects as classes of objects.  We can suppose that the objects are themselves some of the classes,
and we define {\em sets\/} as classes which are elements.  We could allow atoms which are non-sets, but we will see that our particular criterion for sethood
does not cry out for the option of having atoms.

\begin{description}

\item[Primitive notions:]  We use the usual first order logic with equality.  We postulate the primitive binary relation $\in$ of membership.

\item[Sethood:]  We define ${\tt set}(x)$ as $(\exists y:x \in y)$.

\item[Extensionality:]  $(\forall xy.x=y \leftrightarrow (\forall z:x \in x \leftrightarrow z \in y))$

\item[Universe:]  There is a class $V$ such that $(\forall x:x \in V \leftrightarrow {\tt set}(x))$.  The universe is the class of all sets.

\item[Bounded formula:]  A formula $\phi$ is bounded iff all quantifiers in it are restricted to $V$.

\item[Class Comprehension:]  For any bounded formula $\phi$, $\{x \in V:\phi\}$ exists.  That is, for each bounded formula $\phi$ and variable $A$ not appearing in $\phi$,
we have $(\exists A:(\forall x:x \in A \leftrightarrow {\tt set}(x) \wedge \phi))$.

\item[Fancy set notation:]  By $\{F(x_1,\ldots,x_n):\phi\}$ we mean $$\{z\in V:(\exists x_1,\ldots,x_n:z=F(x_1,\ldots,x_n) \wedge \phi)\}.$$

\item[Remark:]  Note that introducing $V$ as a specific class here is just a convenience to make it easier to say what a bounded formula is.

\end{description}

There is a question here on a philosophical level of why we do not assume impredicative comprehension (allowing quantifiers over all classes in instances of comprehension).  Ex post facto, it doesn't work, and we will see this later, but the question still arises as to why we make this restriction.

We want to provide some sets and we want to be able to talk about relations as well as sets.  For this reason we add the following axiom and definition.

\begin{description}

\item[Axiom of elementary sets (following Zermelo):]  The empty class $$\emptyset = \{x\in V:x \neq x\}$$ is a set.  For any sets $x,y$ the set $\{x,y\} = \{z\in V :z =x \vee z=y\}$ is a set.
We define $\{x\}$ as $\{x,x\}$ and note that this axiom provides it for each set $x$.  

\item[Definition (iteration of singleton operation):]

We define $\iota(x)$ as $\{x\}$ and define $\iota^0(x)$ as $x$ and $\iota^{n+1}(x)$ as $\{\iota^n(x)\}$.

\item[Ordered Pairs:]  We define the ordered pair $(x,y)$ as $\{\{x\},\{x,y\}\}$.  Notice that we can define $\pi_1(z)$ as the unique object which belongs to all elements of $z$, and otherwise as $\emptyset$, and define $\pi_2(z)$ as the unique object which belongs to exactly one element of $z$, if there is one, and otherwise as $\emptyset$,
and see that $\pi_i((x_1,x_2)) = x_i$ for $i=1,2$, so we get the basic property of ordered pairs:  if $(x_1,x_2) = (y_1,y_2)$ then $x_1=y_1$ (apply $\pi_1$ to both sides) and $x_2=y_2$ (apply $\pi_2$ to both sides).



\item[Relations:]  We define ${\tt pair}(x)$ as $x=(\pi_1(x),\pi_2(x))$.  We define ${\tt relation}(R)$ as $(\forall x\in R:{\tt pair}(x))$.  A relation is a class of ordered pairs.  We define $x \, R\, y$ as ${\tt relation}(R) \wedge (x,y)\in R$.  We define $R^{-1}$ as $\{(y,x):y \, R\, x\}$.  We define
${\tt dom}(R)$ as $\{x\in V:(\exists y\in V:x \,R\,y)\}$.  We define ${\tt rng}(R)$ as ${\tt dom}(R^{-1})$.

\item[Functions:]  We define ${\tt function}(f)$ as $${\tt relation}(f) \wedge (\forall xyz \in V:x \,f\,y \wedge x\,f\,z \rightarrow y=z).$$   We define
$f`x$ or $f(x)$ as the unique $y$ such that $x\,f\,y$, and otherwise as $\emptyset$.  We define $f``A$ as $\{f(x):x \in A\}$.

\item[Permutations:]  We define ${\tt permutation}(f)$ as $${\tt function}(f) \wedge {\tt dom}(f)=V \wedge {\tt rng}(f)=V \wedge {\tt function}(f^{-1}).$$  We are considering permutations of the entire universe of sets.

\item[Lifted permutations:]  If $\pi$ is a permutation, we define $j[\pi]$ as $$\{(A,f``A):A=A\}$$ if $(\forall A\in V:{\tt set}(f``A))$ and otherwise as $\emptyset$.
Note that this will be a permutation iff it is not $\emptyset$.
We define $j^0[\pi]$ as $\pi$ and $j^{n+1}[\pi]$ as $j[j^n[\pi])$ if it exists.  Note that $j$ is not a function:  it is being ``applied" to permutations which are not in general assumed to be sets.

\item[Setlike permutations:]  We say that a permutation $\pi$ is $n$-setlike iff $j^n[\pi] \neq \emptyset$.  We refer to 2-setlike permutations as simply setlike.  What this means, speaking informally, is that applying $\pi$ to iterated elements $n$ levels down sends sets to sets.

\item[Symmetric classes:]  We say that a class $A$ is $n$-symmetric with support $s$ just in case $s$ is a set and for each $(n-1)$-setlike permutation $\pi$ such
that $j^{n-1}[\pi](s)=s$ we have $j^{n-1}[\pi]``A = A$.  We refer to 3-symmetric classes as simply symmetric.

Speaking informally, an $n$-symmetric class $A$ with support $s$ has the property that if we have a permutation which fixes $s$ when it acts $n-1$ levels down,
it will fix $A$ when it acts $n$ levels down.

\end{description}

We are up to something here.  Mathematics is a theory of structure.  In the background, we have the idea that the classes we want to be sets are those
which represent interesting kinds of structure, and structure is invariant under permutations of the objects the structures are made out of.

The level of symmetry we might want to consider can vary over all natural numbers $n$, but it is quite impossible in the theory we have to quantify over the indices
on ``setlike" and ``symmetric" here.  As it turns out, we will not need to.

We propose the following axiom, which completes our basic theory.

\begin{description}

\item[Set Comprehension:]  For all classes $A$, $A$ is a set iff $A$ is 3-symmetric, that is, ${\tt set}(A)$ is equivalent to existence of a set $s$ such 
that for each permutation $\pi$ such that $j^2[\pi](s)=s$ we have $j^2[\pi]``A=A$.

\end{description}

We now begin the narrative which leads to the perhaps shocking conclusion that we have defined an extension of Quine's New Foundations with no reference to syntax, types, or stratification.

The power of the symmetric comprehension criterion is greater than it seems to be.  To see this, we prove some lemmas.

\begin{description}

\item[Lemma 1:]  If $\pi$ is a 2-setlike permutation, $\pi$ is a 3-setlike permutation, and so an $n$-setlike permutation for each concrete $n$.

\item[Proof of Lemma 1:]  Assume that $\pi$ is 2-setlike.  Assume that $A$ is a set.  Our aim is to prove that $j^2[\pi]``A$ is a set.  This establishes
that $j^3[\pi]$ is not $\emptyset$.

Since $A$ is a set it has a support $s$ such that for any $\rho$ such that $j^2[\rho](s)=s$, we have $j^2[\rho]``A = A$.   We claim that
$j^2[\pi](s)$ is a support for $j^2[\pi]``A$:  suppose that $j^2[\rho](j^2[\pi](s)) = j^2[\pi](s)$;  it follows that $j^2[\pi^{-1} \circ \rho \circ \pi](s) = s$,
so  $j^2[\pi^{-1} \circ \rho \circ \pi]``A = A$, so $j^2[\rho]``(j^2[\pi]``A) = j^2[\pi]``A$, verifying the supportedness claim, and verifying the claim that
$j^3[\pi]$ is a permutation.

Now if we show that $\pi$ is 3-setlike, we have shown that $j[\pi]$ is 2-setlike, so by the previous paragraph $j[\pi]$ is 3-setlike, so $\pi$ is 4-setlike.
If $\pi$ is $n$-setlike $(n \geq 3)$ then $j^{n-2}[\pi]$ is 2-setlike, so $j^{n-2}[\pi]$ is 3-setlike, so $\pi$ is $(n+1)$-setlike.  This is of course
a separate argument for each concrete natural number $n$.

This justifies our usage ``setlike" for ``2-setlike".

\item[Lemma 2:]  If it is the case that $s$ and $t$ are sets and $A$ is a class such that for every $\pi$, if $j^2[\pi](s)=s$ and $j^2[\pi](t)=t$, then $j^2[\pi]``A=A$, 
then $A$ is a set.  This generalizes to ``if $s_1,\ldots,s_n$ are sets such that if for each $\pi$, for each index $i$, $j^2[\pi](s_i)=s_i$, then $j^2[\pi]``A=A$
then $A$ is a set."

\item[Proof of Lemma 2:]  We know that $\{\{s\},\{s,t\}\}$ is a set.  Let $u$ be a support of $\{\{s\},\{s,t\}\}$.  Let $v$ be a support of $u$.
If $j^2[\rho](v)=v$ then $j^3[\rho](u) = u$ whence $j^4[\rho]``\{\{s\},\{s,t\}\}= \{\{s\},\{s,t\}\}$ so $j^2[\rho](s)=s$ and $j^2[\rho](t)=t$.
Thus for any $\pi$ such that $j^2[\rho](v)=v$ we have $j^2[\pi](s)=s$ and $j^2[\pi](t)=t$, so $j^2[\pi]``A=A$, so $A$ is a set with support $v$.

This is iterable:  this allows 2 support conditions to be collapsed into one, and so we can by repeating this process collapse any finite collection of support conditions into one.

If $j^{n+2}[\rho](v)=v$ then $j^{n+3}[\rho](u) = u$ whence $j^{n+4}[\rho]``\{\{s\},\{s,t\}\}= \{\{s\},\{s,t\}\}$ so $j^{n+2}[\rho](s)=s$ and $j^{n+2}[\rho](t)=t$:  note that support conditions for higher indexed forms of symmetry can be merged in the same way.

\item[Remark about Lemma 2:]  The proof shows that Lemma 2 is a consequence of our theory, but
in fact we will immediately develop an explicit description of supports of unordered pairs and so of methods of merging supports;  we are uncomfortable with the idea of appealing to sethood of $\{a,b\}$, which is not justified by existence of a support, to conjure up a support without any idea of what it looks like.

\item[Lemma 3:]  If $a$ and $b$ are sets, $a \cup b$ is a set.

\item[Proof:]  If $s$ is a support of $a$ and $t$ is a support of $b$, then if $j^2[\pi]$ fixes $s$ and fixes $t$, it follows that $j^2[\pi]``(a \cup b) = a \cup b$, so $a \cup b$ is a set by Lemma 2.

\item[Lemma 4:]  If a class $A$ is 4-symmetric, it is 3-symmetric and so a set.  More generally, if a class $A$ is $n$-symmetric with $n>3$, it is 3-symmetric and so a set.

\item[Proof of Lemma 4:]  Suppose that for all $\pi$ such that $j^3[\rho](s)=s$, $j^3[\rho]``A =A$

Let $E = \{\{\{x\},y\}:x \in y\}$.  We claim that any permutation $\rho$ such that $j^2[\rho](E)=E$ is actually of the form $j[\rho']$.
Such a permutation $\rho$ must have $j^2[\rho]``\{\{\{x\}\}:x \in V\}= \{\{\{x\}\}:x \in V\}$, since these are the 1-element elements of $E$.
Define $\rho'$ by $j^2[\rho](\{\{x\}\}) = \{\{\rho'(x)\}\}$.  Observe further that because $j^2[\rho]$ fixes $E$, we have, for any $x \in y$, since this is equivalent to $\{\{x\},y\} \in E$,
that $j[\rho](\{\{x\},y\}) = \{\rho(\{x\}),\rho(y)\} = \{\{\rho'(x)\},\rho(y)\} \in E$, so $\rho'(x) \in \rho(y)$ iff $x \in y$, so $j[\rho']=\rho$.

We construct a $t$ so that $j^2[\pi](t)=t$ implies $j^2[\pi](s)=s$ and $j^2[\pi](E)=E$, so there is $\rho$ such
that $j[\rho]=\pi$, so  $j^3[\rho](s)=s$, so $j^3[\rho]``A =A$, so $j^2[\pi]``A=A$, so $A$ is a set with support $t$.  We could construct $t$ using Lemma 2, but in fact we can describe a $t$ which will work explicitly:  define $s'$ as the class of all $x$ which are either elements of $s$ not of cardinality 1 or 2 or complements of elements of $s$ of cardinality 1 or 2;  note that $s'$ is fixed by elementwise application of any $j[\pi]$ iff $s$ is; thus if $t$ is a support of  $s$, and $j^2[\rho[t]=t$, we have $j^3[\rho](s) = s$, whence we have $j^2[\rho]``s' = s'$, whence $s'$ is a set with the same support as $s$;  then note that $s' \cup E$ is fixed by any $j^2[\pi]$ iff $s'$ is so fixed and $E$ is so fixed, because it is not possible for a permutation $j[\pi]$ to map an element of one of these sets into the other, for cardinality reasons, and further, $s' \cup E$ is a set:  suppose $t$ is a support of $s$ and $j^2[\rho]$ fixes $t$;  then $j^2[\rho]$ fixes $s'$ elementwise as argued above and fixes $E$ elementwise trivially, and so must fix the union elementwise because it cannot map an element of one of these sets to the other, so $s'\cup E$ is a set.  Notice that we have shown all of this without appealing to Lemmas 2 or 3.  So we have shown that $A$ is 3-symmetric with support $s' \cup E$.

Suppose that we have shown that if for all $\pi$ such that $j^n[\rho](s)=s$, $j^n[\rho]``A =A$, then $A$ is a set, for a fixed $n \geq 3$.

Suppose that for all $\pi$ such that $j^{n+1}[\pi](s)=s$, we have $j^{n+1}[\pi]``A =A$.

Thus we have for all $j[\pi]$ such that $j^n[j[\pi]](s) = s$ that $j^n[j[\pi]]``A = A$.

Thus we have for all $\pi$ such that $j^2[\pi](E) = E$ and $j^n[\pi](s)=s$ that $ j^n[\pi]``A = A$.

Thus we have for all $\pi$ such that $j^n[\pi](\iota^{n-2}(E)) = \iota^{n-2}(E)$ and $j^n[\pi](s)=s$ that  $ j^n[\pi]``A = A$, so $A$ is a set by Lemma 2 and the inductive hypothesis.

The result follows for all $n$ by induction in the metatheory.



\end{description}

Notice that we did use Lemma 2 to prove the inductive step (though we could avoid this by similar maneuvers), but we executed the reduction from 4-symmetry to 3-symmetry without using Lemma 2 or 3 at all.

\begin{description}


\item[Lemma 5:]  An unordered pair $\{a,b\}$ has an explicitly computable 3--support.

\item[Proof:]  Observe that both $\{x \cup \{\emptyset\} :x \in a\}$ and $\{x \setminus \{\emptyset\}:x \in a\}$ are fixed by a permutation $j^3[\pi]$ iff $a$ is so fixed.  So a permutation $\pi$ has $j^3[\pi]$ fixing $\{x \cup \{\emptyset\} :x \in a\} \cup \{x \setminus \{\emptyset\}:x \in b\}$
if and only if it has $j^3[\pi]$ fixing both $a$ and $b$, whence $j^4[\pi]$ fixes $\{a,b\}$.  We use Lemma 3 to verify that $\{x \cup \{\emptyset\} :x \in a\} \cup \{x \setminus \{\emptyset\}:x \in b\}$ is a set (it is clearly fixed elementwise by a $j^2[\pi]$ which fixes both a support of $a$ and a support of $b$): this is an actual use of Lemma 2 behind the scenes but we do get an explicit look at what the support looks like.

This gives us an explicitly computable 4-support of $\{a,b\}$ from which we can compute a 3-support explicitly by the method of the proof of Lemma 4.



\end{description}

Armed with stronger symmetry results, we aim for more powerful set theoretical constructions.  The first thing we do is reduce our 
axiom scheme of class comprehension to a finite axiom scheme.  This has philosophical merit, as we might be able to see reasons to resist
quantification over all classes in instances of class comprehension.

Our strategy for reduction of class comprehension is to get the right representation of open formulas with variables in them, then see that we can represent the logical operations on open formulas by class constructions.

The idea is that $\phi(x_1,\ldots,x_n)$ is represented in effect by the class of all functions $f$ sending variables $x_i$ (as syntactical objects) to values which make them true:  $\phi(x_1,\ldots,x_n)$ is represented by
$$\{f:{\tt dom}(f)=\{v_1,\ldots,v_n\} \wedge \phi(f(v_1),\ldots,f(v_n))\}$$ where each $v_i$ is used as a code for the variable $x_i$ as a piece of syntax.  We do not have any order or structure on the ``variables" here.

In what follows, when we say that $\{x:\phi\}$ is a class or exists as a class, we mean that the corresponding instance of class comprehension is taken to be an axiom.  The aim is to show that we need only finitely many instances of the class comprehension scheme.

We make no commitments at all to what sorts of objects can be ``variables", so we simply define a predicate as a class of functions all having the same domain:

\begin{description}

\item[Axiom of domains:]  For any function $f$, ${\tt dom}(f)$ is a class.

\item[Definition (predicate):]  We define ${\tt predicate}(P)$ as $$(\forall fg\in P:{\tt function}(f) \wedge {\tt function}(g) \wedge {\tt dom}(f)={\tt dom}(g)).$$

\item[Definition (domain of a predicate):]  We define ${\tt Dom}(P)$ as $$\{x:(\exists f\in P:x \in {\tt dom}(f))).$$

\item[Definition (negation):]  We define $-P$ as $$\{f:{\tt predicate}(P) \wedge {\tt function}(f) \wedge {\tt dom}(f) = {\tt Dom}(P) \wedge f \not\in P\}.$$  Note that it is usually but not always true that ${\tt Dom}(-P) = {\tt Dom}(P)$:  if $-P$ is empty something dramatic happens.

\item[Axiom of Negation:]  For any predicate $P$, $-P$ is a class.

\item[Definition (merger of value assignments):]  We define $f+g$ as $$\{(x,y):{\tt function}(f) \wedge {\tt function}(g) \wedge$$ $$ ((x,y) \in f \wedge (x,y)\in g \vee (x,y) \in f \wedge x \not\in {\tt dom}(g) \vee (x,y) \in g \wedge x \not\in {\tt dom}(f))\}.$$

\item[Axiom of Mergers:]  For any functions $f,g$ which are sets, $f+g$ is a set.

\item[Remark:]  Note that if $f$ and $g$ are 3-symmetric with given supports, $f+g$ is symmetric with the merged support:  this axiom of set comprehension harmonizes with symmetric comprehension.  It is needed
as an axiom in this approach because of its essential role in the finite axiomatization of class comprehension.

\item[Definition (disjunction):]  We define $P \oplus Q$ as $$\{h:{\tt predicate}(P) \wedge {\tt predicate}(Q) \wedge {\tt function}(h) $$ $$ \wedge (\forall x:x \in {\tt dom}(h) \leftrightarrow x \in {\tt Dom}(P) \vee x \in {\tt Dom}(Q)) $$ $$\wedge ((\exists fk\in V:f \in P \wedge f+k=h) \vee (\exists gk\in V:g \in Q \wedge g+k=h)).$$

\item[Axiom of Disjunction:]  For any predicates $P,Q$, $P \oplus Q$ is a class.

\item[Definition (existential quantifier):]  We define $E_x(P)$ as $$\{g:{\tt predicate}(P) \wedge {\tt function}(g) $$ $$ \wedge (\forall y:y \in {\tt dom}(g) \leftrightarrow y \in {\tt Dom}(P) \wedge y \neq x) \wedge$$ $$ (\exists fh\in V:f \in P \wedge {\tt dom}(h) = \{x\} \wedge f+h = g+h)\}$$

\item[Axiom of Quantification:]  For any set $x$ and predicate $P$, $E_x(P)$ is a class.

\item[Definition (equality):] We define $[=]_{x,y}$ as $\{\{(x,u),(y,u)\}:x \in V \wedge y \in V\}$

\item[Definition (membership):]  We define $[\in]_{x,y}$ as $$\{\{x,u),(y,v)\}:u \in v \wedge (x=y \rightarrow u=v)\}.$$

\item[Axiom of Special Classes:]  For any sets $x,y$, $[=]_{x,y}$  and $[\in]_{x,y}$ exist as classes.

\item[Definition (class constant):]  For any class $C$ we define $C_x$ as $$\{\{(x,c)\}:c \in C\}.$$

\item[Axiom of Class Constants:]  For any class $C$, $C_x$ is a class.

\item[Definition (extraction of a set):]  $$\Sigma(P) = \{x:{\tt predicate}(P) \wedge (\exists v\in V:\{(v,x)\} \in P)\}.$$

\item[Axiom of Extraction:]  For any predicate $P$ with domain a singleton, $\Sigma(P)$ is a class.

\end{description}

Our finite axiomatization asserts the existence of domains of functions, mergers of functions, negations, disjunctions and existential quantifications of predicates, and equality, membership and all class constant predicates and set extractions.  Note that the existence of the predicate $x=a$ for a constant $a$ follows from the axiom of pairing:  the predicate is $\{\{(x,a)\}\}$.   

That this entails class comprehension is immediate:  the construction of $\{x \in V:\phi\}$ is exactly parallel to the structure of the formula $\phi$.
Parameters can be eliminated so that set extraction will work by the device $$\phi(a) \equiv (\exists x:x=a \wedge \phi)$$ (for sets) and use of
class constants for classes on the right of the membership symbol.  When a formula is reduced to a predicate of a single variable, extraction produces the class desired.

It is nice to reduce the class comprehension scheme but this is not our principal aim:  we plan to use a similar scheme to show that stratified comprehension for sets follows from our axioms.

We begin with a suite of theorems about set predicates and related constructions correlated with the axioms for class predicates given above.

\begin{description}

\item[Theorem  of Set Negation:]  For any predicate $P$ which is a set, $-P$ is a set.

\item[Proof:]  If $P$ is 4-symmetric with a given support, so is $-P$, with the same support.

\item[Theorem of Set Disjunction:]  For any predicates $P,Q$ which are sets, $P \oplus Q$ is a set.

\item[Proof:]  If $P$ and $Q$ are each 4-symmetric with given supports, $P \oplus Q$ is 4-symmetric with a merged support.

\item[Theorem  of Set Quantification:]  For any set $x$ and predicate $P$ which is a set, $E_x(P)$ is a set.

\item[Proof:]  If $P$ is 4-symmetric with a given support, so is $E_x(P)$ .

\item[Theorem of Special Sets:]  For any sets $x,y$, $[=]_{x,y}$  and $[\subseteq_1]_{x,y}=\{\{(x,\{u\}),(y,v)\}:u \in v \wedge (x=y \rightarrow \{u\}=v)\} $ exist as sets.

\item[Proof:]  The first set is 4-symmetric, the second is 5-symmetric.


\item[Proof:]


\item[Definition (extraction of a set):]  $$\Sigma(P) = \{x:{\tt predicate}(P) \wedge (\exists v\in V:\{(v,x)\} \in P)\}.$$

\item[Theorem of Extraction:]  For any predicate $P$ with domain a singleton which is a set, $\Sigma(P)$ is a class.

\item[Proof:]  If $P$ is 6-symmetric,  $\Sigma(P)$ is 3-symmetric.

\end{description}

We now need to discuss details of stratified comprehension. 

\begin{description}

\item[Definition (stratified formula):]  A formula $\phi$ is stratified iff there is a function from variables in $\phi$ to natural numbers such that if $x=y$ is an atomic subformula of $\phi$, the natural numbers assigned to $x$ and $y$ are the same, and if $x \in y$ is an atomic subformula of $\phi$, the number assigned to $y$ is the successor of the number assigned to $x$.  A term $\{x:\phi\}$ is assigned a number one greater than the number assigned to $x$.

\item[Representation of stratified predicates:]  We define $\iota(x)$ as $\{x\}$, define $\iota^0(x)$ as $x$ and $\iota^{n+1}(x)$ as $\{\iota^n(x)\}$.  This is convenient as $\iota^n(x)$ is assigned a number in a stratification $n$ higher than that assigned to $x$.

We represent a stratified formula $\phi(x_1,\ldots,x_n)$ in which each $x_i$ is assigned $\tau_i$ by a fixed stratification function by $\{f:{\tt dom}(f)= \{v_1,\ldots,v_n\} \wedge \phi(\iota^{N-\tau_1}(v_1),\ldots,\iota^{N-\tau_n}(v_n))\}$ where $N$ is chosen greater than all the $\tau_i$'s.  This is of course a case of our representation of predicates above.

\end{description}

We need two additional constructions to get set comprehension for stratified formulas with set parameters.


\begin{description}

\item[Definition (type raise a function):]  If $f$ is a function, we
define $f^\iota$ as $\{(\{x\},\{y\}):(x,y)\in f\}$.

\item[Theorem of Singleton Images:]  If $s$ is a set, $\iota``s = \{\{x\}:x \in s\}$ is a class (class comprehension), and in fact a set with support $s$:  any permutation $\pi$ with $j^2[\pi](s)=s$ has $j^2[\pi]``(\iota``s) = \iota``s$.

\item[Theorem of Function Type Raising:]  If $f$ is a function and a set, $f^{\iota}$ is a set.

\item[Proof:]  $f^{\iota}$ is a class by class comprehension, whether in its original form or as finitely axiomatized above.  Suppose that $f$ is fixed by elementwise application of any permutation $j^3[\pi]$ such that $j^3[\pi](s)=s$.
Then $f^{\iota}$ is fixed by elementwise application of $j^4[\pi](s)$   Thus any $\pi$ such that $j^4[\pi]$ fixes $\iota``s =\{\{x\}:x\in s\}$ is fixed by elementwise application of $j^4[\pi](s)$. 

\item[Definition (type raise a predicate):]  If $P$ is a predicate,
we define $P^{\iota+}$ as $\{f^{\iota}:f \in P\}$.

\item[Theorem of Predicate Type Raising:]  If $P$ is a predicate 
and a set, $P^{\iota+}$ is a set.

\item[Proof:]  If $P$ is 4-symmetric with a given support $s$,
$P^{\iota+}$ is 5-symmetric with support $\iota``s$.

\item[Theorem of Union:]  If $\iota``A = \{\{x\}:x \in A\}$ is a set then $A$ is a set.

\item[Proof:]  If $s$ is a support of $\iota``A$, let $t$ be a support of $s$.  If $j^2[\pi](t)=t$ then
$j^3[\pi](s)=x$ so $j^4[\pi](\iota``A)=\iota``A$ so $j^2[\pi]``A=A$:  $A$ has support $t$.

\end{description}

This establishes that stratified comprehension holds:  $\{x \in V:\phi\}$ holds for any bounded stratified formula
with set parameters.  This is done by first converting the formula $\phi$ to the form in which all free variables appear packaged in iterated singletons of the same type.  All atomic formulas then become instances of type raised versions of $=$ or $\subseteq_1$.  All logical operations are provided.  Set parameters can be stripped out as in reduction of class comprehension.  The set obtained by extraction may need to have union applied a number of times to get the desired set,
since $x$ is replaced by $\iota^{N-\tau_x}(x)$, where $\tau_x$ is the number assigned to $x$ by the stratification function.

It is very neat how stratified comprehension for sets falls out of the finite axiomatization of class comprehension, which just follows the logical structure of formulas, and the devices for type raising and lowering.

At this point, we have established that our theory entails NF, a quite strong and mathematically capable system, and we can do lots of standard mathematics.

The theory does not seem to be exactly NF, even in its assertions about sets alone.  It is a theorem that for any set $A$ there
is a set $s$ such that for any {\em set\/}  permutation $\pi$, if $j^2[\pi](s) = s$ then $j^3[\pi](A)=A$.  We do not know a way to prove this in NF.  And of course it has a lot to say about classes which are not sets;  in fact it has more to say about these than is exactly comfortable.

NF has a theory of ordinals as equivalence classes of well-orderings under similarity.  It is well known that it avoids the Burali-Forti paradox by the fact that the order type of the natural order on the ordinal less than $\alpha$ is not as a rule $\alpha$:  it is
$T^4(\alpha)$, the set of $W^{\iota^4}$ such that $W \in \alpha$, and if $\Omega$ is the order type of the natural order on the ordinals, we have $T^4(\Omega)<\Omega$.  We then get an external decreasing sequence of ordinals,  whence the natural order on the ordinals is see
from the outside to not be a well-ordering at all.  It remains a well-ordering in the internal sense, because the sequence $\{T^{4i}(\Omega)\}_{i \in {\mathbb N}}$ is not a set.

Now we can show that impredicative class comprehension is inconsistent with our theory.  We could, with impredicative comprehension for classes, define the class of true well-orderings, in which every nonempty subclass [not just every nonempty subset] of the domain has a minimal element.  This class would be a set, because it is 5-symmetric with empty support.  The order type of the natural order on the true well-orderings would be an ordinal, and moreover it would have to be  a true well-ordering:  the Burali-Forti paradox would be revived.  So the collection of true well-orderings is a collection of sets which cannot be a class at all.



\end{document}